(()=>{"use strict";const t=function(){function t(t,n,r,e,o){void 0===n&&(n=1/0),void 0===r&&(r=0),void 0===e&&(e=function(){return!0}),void 0===o&&(o=!1),this.preparedQuery=null,this._limit=null,this._offset=null,this._filter=null,this._desc=!1,this.preparedQuery=t,this._limit=n,this._offset=r,this._filter=e,this._desc=o}return t.prototype.makeFromParams=function(n){var r=n.limit,e=n.offset,o=n.filter,i=n.desc;return new t(this.preparedQuery,null!=r?r:this._limit,null!=e?e:this._offset,null!=o?o:this._filter,null!=i&&i)},t.prototype.limit=function(t){return this.makeFromParams({limit:t})},t.prototype.offset=function(t){return this.makeFromParams({offset:t})},t.prototype.filter=function(t){return this.makeFromParams({filter:t})},t.prototype.desc=function(){return this.makeFromParams({desc:!0})},t.prototype.get=function(){return this.preparedQuery.run(this._limit,this._offset,this._filter,this._desc)},t}(),n=function(){function t(t){this.transactionResolver=t}return t.prototype.makeObjectStoreTransaction=function(t){return this.transactionResolver(t)},t}();var r,e=(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});const o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.run=function(t){var n=this;return new Promise((function(r,e){var o=n.makeObjectStoreTransaction("readwrite").delete(t);o.onsuccess=function(t){r(t)},o.onerror=function(t){e(t)}}))},n}(n);var i=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}();const c=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.run=function(t){var n=this;return new Promise((function(r,e){var o=n.makeObjectStoreTransaction("readwrite").add(t);o.onsuccess=function(t){r(t)},o.onerror=function(t){e(t)}}))},n}(n),u=function(){function t(t){this.items=t,this.qty=t.length}return t.prototype.first=function(){var t;return null!==(t=this.items[0])&&void 0!==t?t:null},t.prototype.last=function(){return this.qty?this.items[this.qty-1]:null},t}();var a=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}();const s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return a(n,t),n.prototype.run=function(t,n,r,e){var o=this;return new Promise((function(i,c){var a=o.makeObjectStoreTransaction("readonly").openCursor(void 0,e?"prev":void 0),s=[];a.onsuccess=function(){var e=a.result;if(e){var o=e.value;if(!r(o))return e.continue();if(n>=1)return n--,e.continue();t--,s.push(o),t<1?i(new u(s)):e.continue()}else i(new u(s))},a.onerror=function(t){c(t)}}))},n}(n);var f=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}();const p=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),n.prototype.run=function(t){var n=this;return new Promise((function(r,e){var o=n.makeObjectStoreTransaction("readonly").get(t);o.onsuccess=function(){r(o.result)},o.onerror=function(t){e(t)}}))},n}(n);var l=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}();const y=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return l(n,t),n.prototype.run=function(t){var n=this;return new Promise((function(r,e){var o=n.makeObjectStoreTransaction("readwrite").put(t);o.onsuccess=function(t){r(t)},o.onerror=function(t){e(t)}}))},n}(n);var h=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}();const v=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return h(n,t),n.prototype.run=function(t){var n=this;return new Promise((function(r,e){var o=n.makeObjectStoreTransaction("readwrite");o.transaction.addEventListener("complete",(function(t){return r(t)})),o.transaction.addEventListener("abort",(function(t){return r(t)})),o.transaction.addEventListener("error",(function(t){return e(t)})),t.forEach((function(t){return o.add(t)})),o.transaction.commit()}))},n}(n);var d=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}();const w=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return d(n,t),n.prototype.run=function(t){var n=this;return new Promise((function(r,e){var o=n.makeObjectStoreTransaction("readwrite");o.transaction.addEventListener("complete",(function(t){return r(t)})),o.transaction.addEventListener("abort",(function(t){return r(t)})),o.transaction.addEventListener("error",(function(t){return e(t)})),t.forEach((function(t){return o.delete(t)})),o.transaction.commit()}))},n}(n);var m=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}();const _=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return m(n,t),n.prototype.run=function(t){var n=this;return new Promise((function(r,e){var o=n.makeObjectStoreTransaction("readwrite");o.transaction.addEventListener("complete",(function(t){return r(t)})),o.transaction.addEventListener("abort",(function(t){return r(t)})),o.transaction.addEventListener("error",(function(t){return e(t)})),t.forEach((function(t){return o.put(t)})),o.transaction.commit()}))},n}(n);!function(){function n(t,n){this.connection=t,this.name=n}n.prototype.makeStorageTransactionFactory=function(){var t=this;return function(n){return t.connection.db.transaction(t.name,n).objectStore(t.name)}},n.prototype.filter=function(n){var r=new s(this.makeStorageTransactionFactory());return new t(r).filter(n)},n.prototype.limit=function(n){var r=new s(this.makeStorageTransactionFactory());return new t(r).limit(n)},n.prototype.offset=function(n){var r=new s(this.makeStorageTransactionFactory());return new t(r).offset(n)},n.prototype.desc=function(){var n=new s(this.makeStorageTransactionFactory());return new t(n).desc()},n.prototype.get=function(){var n=new s(this.makeStorageTransactionFactory());return new t(n).get()},n.prototype.find=function(t){return new p(this.makeStorageTransactionFactory()).run(t)},n.prototype.insert=function(t){return new c(this.makeStorageTransactionFactory()).run(t)},n.prototype.insertBatch=function(t){return new v(this.makeStorageTransactionFactory()).run(t)},n.prototype.update=function(t){return new y(this.makeStorageTransactionFactory()).run(t)},n.prototype.updateBatch=function(t){return new _(this.makeStorageTransactionFactory()).run(t)},n.prototype.delete=function(t){return new o(this.makeStorageTransactionFactory()).run(t)},n.prototype.deleteBatch=function(t){return new w(this.makeStorageTransactionFactory()).run(t)}}();var b={keyPath:"id",autoIncrement:!0};!function(){function t(t){this.db=t}t.createFromConfigList=function(t,n,r){return void 0===r&&(r=[]),new Promise((function(e,o){var i=indexedDB.open(t,n);i.onupgradeneeded=function(){for(var t,n=i.result,o=0,c=r;o<c.length;o++){var u=c[o];n.createObjectStore(u.name,Object.assign(b,null!==(t=null==u?void 0:u.options)&&void 0!==t?t:{}))}n.close(),e()},i.onerror=function(t){o(t)},i.onsuccess=function(){o(new Error("Unexpected event"))}}))},t.resolveConnection=function(t,n){return new Promise((function(r,e){var o=indexedDB.open(t,n);o.onsuccess=function(t){r(o.result)},o.onerror=function(t){e(t)},o.onupgradeneeded=function(){e(new Error("Unexpected event"))}}))},t.create=function(n,r,e,o){var i=this;return void 0===r&&(r=[]),void 0===e&&(e=function(t){}),void 0===o&&(o=function(t,n){}),new Promise((function(c,u){return a=i,s=void 0,p=function(){var i,u,a,s,f,p,l,y,h,v,d,w;return function(t,n){var r,e,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(a){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(c=0)),c;)try{if(r=1,e&&(o=2&u[0]?e.return:u[0]?e.throw||((o=e.return)&&o.call(e),0):e.next)&&!(o=o.call(e,u[1])).done)return o;switch(e=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return c.label++,{value:u[1],done:!1};case 5:c.label++,e=u[1],u=[0];continue;case 7:u=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){c=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){c.label=u[1];break}if(6===u[0]&&c.label<o[1]){c.label=o[1],o=u;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(u);break}o[2]&&c.ops.pop(),c.trys.pop();continue}u=n.call(t,c)}catch(t){u=[6,t],e=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}}(this,(function(m){switch(m.label){case 0:return[4,indexedDB.databases()];case 1:return i=m.sent(),(u=i.find((function(t){return t.name===n})))?[3,4]:(e(n),[4,this.createFromConfigList(n,1,r)]);case 2:return m.sent(),a=c,s=t.bind,[4,this.resolveConnection(n,1)];case 3:return a.apply(void 0,[new(s.apply(t,[void 0,m.sent()]))]),[2];case 4:return[4,this.resolveConnection(n,u.version)];case 5:for(f=m.sent(),p=[],l=0,y=r;l<y.length;l++)h=y[l],f.objectStoreNames.contains(h.name)||p.push(h);return p.length?(f.close(),v=u.version+1,o(n,v),[4,this.createFromConfigList(n,v,p)]):(c(new t(f)),[2]);case 6:return m.sent(),d=c,w=t.bind,[4,this.resolveConnection(n,v)];case 7:return d.apply(void 0,[new(w.apply(t,[void 0,m.sent()]))]),[2]}}))},new((f=void 0)||(f=Promise))((function(t,n){function r(t){try{o(p.next(t))}catch(t){n(t)}}function e(t){try{o(p.throw(t))}catch(t){n(t)}}function o(n){var o;n.done?t(n.value):(o=n.value,o instanceof f?o:new f((function(t){t(o)}))).then(r,e)}o((p=p.apply(a,s||[])).next())}));var a,s,f,p}))}}()})();